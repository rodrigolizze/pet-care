<%= form_with model: current_user,
              url:  (current_user.sitter? ? update_sitter_users_path : become_sitter_users_path),
              method: (current_user.sitter? ? :patch : :post),
              local: true,
              html: { class: "row g-4", multipart: true } do |f| %>

  <%# Erros %>
  <% if f.object.errors.any? %>
    <div class="col-12">
      <div class="alert alert-danger mb-0">
        <strong>Por favor, corrija os seguintes campos:</strong>
        <ul class="mb-0">
          <% f.object.errors.full_messages.each do |msg| %>
            <li><%= msg %></li>
          <% end %>
        </ul>
      </div>
    </div>
  <% end %>

  <%# Perfil %>
  <div class="col-12">
    <div class="border rounded p-3 p-md-4">
      <h2 class="h6 text-muted mb-3">Perfil</h2>

      <div class="mb-3">
        <%= f.label :bio, "Sobre", class: "form-label fw-semibold" %>
        <%= f.text_area :bio, rows: 4, class: "form-control",
              placeholder: "Fale sobre sua rotina, preferências e cuidados que oferece" %>
      </div>

      <div class="mb-0">
        <%= f.label :experience, "Experiência", class: "form-label fw-semibold" %>
        <%= f.text_area :experience, rows: 4, class: "form-control",
              placeholder: "Inclua certificações e sua experiência com pets" %>
      </div>
    </div>
  </div>

  <%# Preferências %>
  <div class="col-12">
    <div class="border rounded p-3 p-md-4">
      <h2 class="h6 text-muted mb-3">Preferências</h2>

      <div class="row g-3">
        <div class="col-12 col-md-6">
          <%= f.label :property_type, "Moro em", class: "form-label fw-semibold" %>
          <div class="input-group">
            <span class="input-group-text bg-white"><i class="bi bi-house-door"></i></span>
            <%= f.select :property_type,
                  options_for_select(
                    User::PROPERTY_TYPES.map { |p| [p == "house" ? "Casa" : "Apartamento", p] },
                    current_user.property_type
                  ),
                  { include_blank: "Selecione..." },
                  class: "form-select" %>
          </div>
        </div>

        <div class="col-12 col-md-6">
          <%= f.label :animal_sizes, "Aceito animais", class: "form-label fw-semibold" %>
          <% size_labels = { "small" => "Pequeno", "medium" => "Médio", "big" => "Grande", "all" => "Todos" } %>
          <div class="input-group">
            <span class="input-group-text bg-white"><i class="bi bi-arrows-fullscreen"></i></span>
            <%= f.select :animal_sizes,
                  options_for_select(
                    User::ANIMAL_SIZES.map { |a| [size_labels[a], a] },
                    current_user.animal_sizes
                  ),
                  { include_blank: "Selecione..." },
                  class: "form-select" %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <%# Estrutura %>
  <div class="col-12">
    <div class="border rounded p-3 p-md-4">
      <h2 class="h6 text-muted mb-3">Estrutura</h2>

      <div class="row g-3">
        <div class="col-12 col-md-4">
          <div class="form-check form-switch">
            <%= f.check_box :backyard, class: "form-check-input", id: "user_backyard" %>
            <%= f.label :backyard, "Possui área externa", class: "form-check-label", for: "user_backyard" %>
          </div>
        </div>

        <div class="col-12 col-md-4">
          <div class="form-check form-switch">
            <%= f.check_box :has_pet, class: "form-check-input", id: "user_has_pet" %>
            <%= f.label :has_pet, "Tem animais", class: "form-check-label", for: "user_has_pet" %>
          </div>
        </div>

        <div class="col-12 col-md-4">
          <div class="form-check form-switch">
            <%= f.check_box :screened_windows, class: "form-check-input", id: "user_screened_windows" %>
            <%= f.label :screened_windows, "Janelas teladas", class: "form-check-label", for: "user_screened_windows" %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <%# Fotos %>
  <div class="col-12">
    <div class="border rounded p-3 p-md-4">
      <h2 class="h6 text-muted mb-3">Fotos do local</h2>
      <%= f.file_field :place_photos, multiple: true, accept: "image/*",
            direct_upload: true, class: "form-control" %>
      <div class="form-text">Selecione várias imagens (JPG/PNG/WebP). Até ~10MB por foto.</div>
    </div>
  </div>

  <%# Ações %>
  <div class="col-12 d-flex flex-wrap gap-2 pt-1">
    <button type="submit" class="btn btn-primary d-inline-flex align-items-center gap-2 rounded-pill">
      <i class="bi <%= current_user.sitter? ? 'bi-pencil-square' : 'bi-paw' %>"></i>
      <span><%= current_user.sitter? ? "Atualizar informações" : "Torne-se um Cuidador" %></span>
    </button>
    <%# Ex: cancelar
    <%#= link_to "Cancelar", request.referer || root_path, class: "btn btn-outline-secondary rounded-pill" %>
  </div>
<% end %>
