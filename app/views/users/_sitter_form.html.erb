<%# Form: become or edit sitter %>
<%= form_with model: current_user,
              url:  current_user.sitter? ? update_sitter_users_path : become_sitter_users_path,
              method: current_user.sitter? ? :patch : :post,
              local: true,
              html: { class: "row g-3" } do |f| %>

  <%# Error summary %>
  <% if f.object.errors.any? %>
    <div class="alert alert-danger w-100">
      <strong>Por favor, corrija os seguintes campos:</strong>
      <ul class="mb-0">
        <% f.object.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <%# Sobre / Experiência %>
  <div class="col-12">
    <%= f.label :bio, "Sobre", class: "form-label fw-semibold" %>
    <%= f.text_area :bio, class: "form-control", rows: 4,
            placeholder: "Fale sobre sua rotina, preferências e cuidados que oferece" %>
  </div>

  <div class="col-12">
    <%= f.label :experience, "Experiência", class: "form-label fw-semibold" %>
    <%= f.text_area :experience, class: "form-control", rows: 4,
            placeholder: "Inclua certificações e sua experiência com pets" %>
  </div>

  <div class="d-inline-block mb-3">
    <%= f.label :property_type, "Moro em:" %>
    <%= f.select :property_type,
                  options_for_select(
                    User::PROPERTY_TYPES.map { |p| p == "house" ? ["Casa", p] : ["Apartamento", p] },
                    current_user.property_type),
                  include_blank: "Selecione..." %>

    <%= f.label :animal_sizes, "Aceito animais:" %>
    <%= f.select :animal_sizes,
                  options_for_select(
                    User::ANIMAL_SIZES.map { |a|
                      case a
                      when "small" then ["Pequeno", a]
                      when "medium" then ["Médio", a]
                      when "big" then ["Grande", a]
                      when "all" then ["Todos", a]
                      end
                    },
                    current_user.animal_sizes),
                  include_blank: "Selecione..." %>
  </div>

  <div class="d-flex justify-content-between">
    <div>
      <%= f.label :backyard, "Possui área externa" %>
      <%= f.check_box :backyard %>
    </div>
    <div>
      <%= f.label :has_pet, "Tem animais" %>
      <%= f.check_box :has_pet %>
    </div>
    <div>
      <%= f.label :screened_windows, "Janelas teladas" %>
      <%= f.check_box :screened_windows %>
    </div>
  </div>

  <%# Actions %>
  <div class="col-12 d-flex flex-wrap gap-2 pt-2">
    <button type="submit" class="btn btn-ps d-inline-flex align-items-center gap-2">
      <i class="bi <%= current_user.sitter? ? 'bi-pencil-square' : 'bi-paw' %>"></i>
    <div>
      <%= f.label :place_photos, "Fotos do local" %>
      <%= f.file_field :place_photos, multiple: true, class: "form-control" %>
    </div>
  <br>

  <div>
    <button type="submit" class="btn <%= current_user.sitter? ? 'btn-warning' : 'btn-primary' %>">
      <i class="fa-solid <%= current_user.sitter? ? 'fa-pen' : 'fa-paw' %>"></i>
      <%= current_user.sitter? ? "Atualizar informações" : "Torne-se um Cuidador" %>
    </button>

    <%# Optional: a neutral cancel/back link if you want %>
    <%#= link_to "Cancelar", request.referer || root_path, class: "btn btn-outline-secondary rounded-pill" %>
  </div>
<% end %>
