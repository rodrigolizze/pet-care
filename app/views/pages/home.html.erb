<div class="banner" style="background-image: linear-gradient(rgba(0,0,0,0.4),rgba(0,0,0,0.4)), url(<%= asset_path 'banner2.jpeg' %>);">
  <h1 class=txt-banner><strong>Precisa deixar seu pet com alguém?
    <br>
    Deixa com a gente.</strong>
  </h1>
  <div class="container">
    <%# --- Search block only on the home page (ignores query params) --- %>
    <% if request.path == root_path %>
      <div class="container mt-4 search">
        <div class="row justify-content-center">
          <div class="col-lg-10">
            <h1 class="mb-3 ps-title text-gradient-emerald">Encontre um Pet Sitter</h1>

            <%= simple_form_for :search, url: root_path, method: :get, html: { class: 'row g-2 align-items-end' } do |f| %>
              <div class="col-md-3">
                <%= f.input :city, label: false, placeholder: "Onde o seu pet ficará?", wrapper: false,
                            input_html: { value: params.dig(:search, :city), class: 'form-control' } %>
              </div>

<div class="col-md-2">
  <div class="input-group flatpickr" data-controller="flatpickr" data-wrap="true">
    <%= f.input :start_date, label: false, wrapper: false,
                input_html: { type: 'text', class: 'form-control', "data-input": true,
                              placeholder: "Check-in",
                              value: params.dig(:search, :start_date) } %>
    <span class="input-group-text" data-toggle><i class="bi bi-calendar-date"></i></span>
  </div>
</div>

<div class="col-md-2">
  <div class="input-group flatpickr" data-controller="flatpickr" data-wrap="true">
    <%= f.input :end_date, label: false, wrapper: false,
                input_html: { type: 'text', class: 'form-control', "data-input": true,
                              placeholder: "Check-out",
                              value: params.dig(:search, :end_date) } %>
    <span class="input-group-text" data-toggle><i class="bi bi-calendar-date"></i></span>
  </div>
</div>

              <div class="col-md-2">
                <div class="d-grid h-100">
                  <%= f.button :submit, "Buscar", class: "btn btn-success h-100" %>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>


<div class="container py-4">
  <div class="d-flex align-items-center justify-content-between mb-3">
    <h1 class="ps-title m-0 text-gradient-indigo">Cuidadores</h1>
  </div>

  <% if @sitters.present? %>
    <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-3 g-3">
      <% @sitters.each do |sitter| %>
        <div class="col">
          <div class="ps-card h-100 border-0 card-hover overflow-hidden">
            <%= link_to user_path(sitter), class: "text-decoration-none text-reset" do %>

              <!-- Foto -->
              <div class="position-relative sitter-photo ratio ratio-16x9 bg-light">
                <% if sitter.photo.attached? %>
                  <%= cl_image_tag(
                        sitter.photo.key,
                        crop: :fill, gravity: :face,
                        fetch_format: :auto, quality: :auto,
                        class: "w-100 h-100",
                        alt: "Foto de #{sitter.name}"
                      ) %>
                <% else %>
                  <%= cl_image_tag(
                        "c5ldsjbxtnqcwksfgsn0", # seu public_id default
                        crop: :fill, gravity: :face,
                        fetch_format: :auto, quality: :auto,
                        class: "w-100 h-100",
                        alt: "Foto de #{sitter.name}"
                      ) %>
                <% end %>

                <!-- Selo/etiqueta -->
                <%# <span class="ps-chip chip-emerald position-absolute top-0 start-0 m-2 d-none d-sm-inline">
                  Disponível
                </span> %>
              </div>

              <!-- Infos -->
              <div class="p-3">
                <div class="d-flex align-items-center justify-content-between">
                  <h3 class="h4 m-0 ps-title"><%= sitter.name %></h3>
                </div>
                <div class="text-muted mt-1">
                  <i class="bi bi-geo-alt me-1"></i>
                  <%= sitter.address %> -
                  <%= sitter.city %>
                </div>
              </div>
            <% end %>

            <!-- Ações -->
            <div class="px-3 pb-3">
              <%= link_to user_path(sitter),
                          class: "btn btn-ps btn-sm rounded-pill d-inline-flex align-items-center gap-2" do %>
                <i class="bi bi-person-heart"></i>
                <span>Ver Perfil</span>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  <% else %>
    <div class="text-center py-5">
      <div class="ps-card border-0 shadow-sm d-inline-block px-4 py-3">
        <p class="m-0 text-muted">Nenhum sitter encontrado</p>
      </div>
    </div>
  <% end %>
</div>
